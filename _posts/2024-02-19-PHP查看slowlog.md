---
layout:     post
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - PHP
---

说明：比如网站打开很慢，最先想到的是打断点一点点查看，但是感觉有点费时。其实可以开启php-fpm的slowlog先大概看下代码运行情况，可能一下就知道慢的原因了。


网上找了个例子：https://www.cnblogs.com/wt645631686/p/12173664.html

案例：
测试环境、预发布环境经过QA多番测试没有遇到问题，但在一次上线过程中，在线上环境出现20秒的响应超时，这个毫无疑问，环境问题。
尽管线上数据量大，可Mysql也不至于慢到20秒，而且发现每次几乎都是20.01~20.04秒之间，相差不到一秒钟，mysql也不至于这么均匀，在好奇心下，运维大神配合查了一下Mysql慢查询日志，发现没有超时的sql日志，那这有可能就是php这边出现的问题，可一想，逻辑执行也总不能这么慢。想打日志一步步跟踪，这种方式有点慢。mysql 有慢查询，同样咱php也有慢日志。
使用php slow方式确实找到了问题所在。
pconnect()原因导致，这个我当然清楚，是因为连接redis失败导致。 因为是在新的服务器，所以连接不上核心项目的redis服务器，最终还是运维大神安装的证书解决。